

[92mUsing device:[0m cuda:0
[92mData loaded: [0m
Training dataset size:  9843
Number of classes:  40
Sample pointcloud shape:  torch.Size([1000, 3])
Class:  airplane 

[92mData loaded: [0m
Validation dataset size:  2468
Number of classes:  40
Sample pointcloud shape:  torch.Size([1000, 3])
Class:  airplane 

[94mNetwork ready for training:[0m
======================================================================
Layer (type:depth-idx)                        Param #
======================================================================
DeepSetsEquivariant                           --
â”œâ”€Sequential: 1-1                             --
â”‚    â””â”€PermutationEquivariantMean: 2-1        --
â”‚    â”‚    â””â”€Linear: 3-1                       1,024
â”‚    â”‚    â””â”€Linear: 3-2                       768
â”‚    â””â”€Tanh: 2-2                              --
â”‚    â””â”€PermutationEquivariantMean: 2-3        --
â”‚    â”‚    â””â”€Linear: 3-3                       65,792
â”‚    â”‚    â””â”€Linear: 3-4                       65,536
â”‚    â””â”€Tanh: 2-4                              --
â”‚    â””â”€PermutationEquivariantMean: 2-5        --
â”‚    â”‚    â””â”€Linear: 3-5                       65,792
â”‚    â”‚    â””â”€Linear: 3-6                       65,536
â”‚    â””â”€Tanh: 2-6                              --
â”œâ”€Sequential: 1-2                             --
â”‚    â””â”€Dropout: 2-7                           --
â”‚    â””â”€Linear: 2-8                            65,792
â”‚    â””â”€Tanh: 2-9                              --
â”‚    â””â”€Dropout: 2-10                          --
â”‚    â””â”€Linear: 2-11                           10,280
======================================================================
Total params: 340,520
Trainable params: 340,520
Non-trainable params: 0
======================================================================
[92mOptimizer summary: [0m
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 1e-07
)
[96m

Training the deepsets model...[0m
Traceback (most recent call last):
  File "/data/deodagiu/distinv/deepsets/train.py", line 191, in <module>
    main(config)
  File "/data/deodagiu/distinv/deepsets/train.py", line 30, in main
    hist = train(model, train_data, valid_data, device, config['training_hyperparams'])
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/deodagiu/distinv/deepsets/train.py", line 118, in train
    x_valid = valid_data['pointcloud'].to(device).float()
              ~~~~~~~~~~^^^^^^^^^^^^^^
TypeError: 'DataLoader' object is not subscriptable
